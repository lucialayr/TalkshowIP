scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_point(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
all_comb = df_area %>%
expand(Week, !!rlang::sym(variable)) %>%
left_join(df_area) %>%
mutate(share = replace_na(share, 0.000001))
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_point(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
#geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_point(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
#geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_point(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5, shape = 21) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
all_comb = df_area %>%
expand(Week, !!rlang::sym(variable)) %>%
left_join(df_area) %>%
mutate(share = replace_na(share, 0))
ggplot() + theme_void() +
#geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_point(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5, shape = 21) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
all_comb = df_area %>%
expand(Week, !!rlang::sym(variable)) %>%
left_join(df_area) %>%
mutate(share = replace_na(c(Sunday,share), 0))
all_comb = df_area %>%
expand(Week, !!rlang::sym(variable)) %>%
left_join(df_area) %>%
mutate(share = replace_na(list(Sunday,share), 0))
all_comb = df_area %>%
expand(Week, !!rlang::sym(variable)) %>%
left_join(df_area) %>%
mutate(share = replace_na(share, 0),
Sunday = replace_na(Sunday, 0))
all_comb = df_area %>%
expand(Sunday, !!rlang::sym(variable)) %>%
left_join(df_area) %>%
mutate(share = replace_na(share, 0))
ggplot() + theme_void() +
#geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_point(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5, shape = 21) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_point(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5, shape = 21) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
df_area = df %>%
mutate(Datum = as.Date(Datum, format = "%d.%m.%y")) %>%
filter(Datum >= as.Date(start), Datum <= as.Date(end)) %>%
mutate(Week = lubridate::week(Datum),
Sunday = Datum - lubridate::wday(Datum) + 1) %>%
select(Week, Datum, Sunday, Name, !!rlang::sym(variable)) %>%
unique() %>%
group_by(Week, Sunday, !!rlang::sym(variable)) %>%
count(name = "variable_per_week") %>%
mutate(indicator = case_when(!!rlang::sym(variable) %in% c("deutsch", "israelisch",
"jüdisch", "palestinänsisch") ~ !!rlang::sym(variable),
variable_per_week > thresh ~ !!rlang::sym(variable),
TRUE ~ "andere"))
View(df_area)
df_area = df %>%
mutate(Datum = as.Date(Datum, format = "%d.%m.%y")) %>%
filter(Datum >= as.Date(start), Datum <= as.Date(end)) %>%
mutate(Week = lubridate::week(Datum),
Sunday = Datum - lubridate::wday(Datum) + 1) %>%
select(Week, Datum, Sunday, Name, !!rlang::sym(variable)) %>%
unique() %>%
group_by(Week, Sunday, !!rlang::sym(variable)) %>%
count(name = "variable_per_week") %>%
mutate(indicator = case_when(!!rlang::sym(variable) %in% c("deutsch", "israelisch",
"jüdisch", "palestinänsisch") ~ !!rlang::sym(variable),
variable_per_week > thresh ~ !!rlang::sym(variable),
TRUE ~ "andere")) %>%
group_by(Week, Sunday, indicator) %>%
mutate(variable_per_week = sum(variable_per_week))
df_area = df %>%
mutate(Datum = as.Date(Datum, format = "%d.%m.%y")) %>%
filter(Datum >= as.Date(start), Datum <= as.Date(end)) %>%
mutate(Week = lubridate::week(Datum),
Sunday = Datum - lubridate::wday(Datum) + 1) %>%
select(Week, Datum, Sunday, Name, !!rlang::sym(variable)) %>%
unique() %>%
group_by(Week, Sunday, !!rlang::sym(variable)) %>%
count(name = "variable_per_week") %>%
mutate(indicator = case_when(!!rlang::sym(variable) %in% c("deutsch", "israelisch",
"jüdisch", "palestinänsisch") ~ !!rlang::sym(variable),
variable_per_week > thresh ~ !!rlang::sym(variable),
TRUE ~ "andere")) %>%
ungroup() %>%
group_by(Week, Sunday, indicator) %>%
mutate(variable_per_week = sum(variable_per_week))
df_area = df %>%
mutate(Datum = as.Date(Datum, format = "%d.%m.%y")) %>%
filter(Datum >= as.Date(start), Datum <= as.Date(end)) %>%
mutate(Week = lubridate::week(Datum),
Sunday = Datum - lubridate::wday(Datum) + 1) %>%
select(Week, Datum, Sunday, Name, !!rlang::sym(variable)) %>%
unique() %>%
group_by(Week, Sunday, !!rlang::sym(variable)) %>%
count(name = "variable_per_week") %>%
mutate(indicator = case_when(!!rlang::sym(variable) %in% c("deutsch", "israelisch",
"jüdisch", "palestinänsisch") ~ !!rlang::sym(variable),
variable_per_week > thresh ~ !!rlang::sym(variable),
TRUE ~ "andere")) %>%
ungroup() %>%
group_by(Week, Sunday, indicator) %>%
mutate(variable_per_week = sum(variable_per_week)) %>%
select(Week, Sunday, variable_per_week, indicator) %>%
unique()
group_by(Week) %>%
mutate(share = variable_per_week/sum(variable_per_week)) %>%
left_join(df_date) %>%
mutate(share = share*n) %>%
ungroup()
df_area = df %>%
mutate(Datum = as.Date(Datum, format = "%d.%m.%y")) %>%
filter(Datum >= as.Date(start), Datum <= as.Date(end)) %>%
mutate(Week = lubridate::week(Datum),
Sunday = Datum - lubridate::wday(Datum) + 1) %>%
select(Week, Datum, Sunday, Name, !!rlang::sym(variable)) %>%
unique() %>%
group_by(Week, Sunday, !!rlang::sym(variable)) %>%
count(name = "variable_per_week") %>%
mutate(indicator = case_when(!!rlang::sym(variable) %in% c("deutsch", "israelisch",
"jüdisch", "palestinänsisch") ~ !!rlang::sym(variable),
variable_per_week > thresh ~ !!rlang::sym(variable),
TRUE ~ "andere")) %>%
ungroup() %>%
group_by(Week, Sunday, indicator) %>%
mutate(variable_per_week = sum(variable_per_week)) %>%
select(Week, Sunday, variable_per_week, indicator) %>%
unique() %>%
group_by(Week) %>%
mutate(share = variable_per_week/sum(variable_per_week)) %>%
left_join(df_date) %>%
mutate(share = share*n) %>%
ungroup()
all_comb = df_area %>%
expand(Sunday, !!rlang::sym(variable)) %>%
left_join(df_area) %>%
mutate(share = replace_na(share, 0)) %>%
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
all_comb = df_area %>%
expand(Sunday, indicator) %>%
left_join(df_area) %>%
mutate(share = replace_na(share, 0)) %>%
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
all_comb = df_area %>%
expand(Sunday, indicator) %>%
left_join(df_area) %>%
mutate(share = replace_na(share, 0))
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = !!rlang::sym(variable)), color = "black", alpha = .5) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indivator), color = "black", alpha = .5) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = .5) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
runApp("code/shiny")
runApp("code/shiny")
runApp("code/shiny")
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_continuous(name = "Wochenbeginn (Sonntag") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1, name = variable)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_continuous(name = "Wochenbeginn (Sonntag") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1, name = variable)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_date(name = "Wochenbeginn (Sonntag") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1, name = variable)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
runApp("code/shiny")
runApp("code/shiny")
runApp("code/shiny")
colorscheme = "lapaz"
runApp("code/shiny")
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_date(name = "Wochenbeginn (Sonntag)") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = colorscheme, direction = 1, name = variable)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_date(name = "Wochenbeginn (Sonntag)") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = colorscheme, direction = 1, name = variable, end = .8)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_date(name = "Wochenbeginn (Sonntag)") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = colorscheme, direction = 1, name = variable, end = .7)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_date(name = "Wochenbeginn (Sonntag)") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = colorscheme, direction = 1, name = variable, end = .9)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_date(name = "Wochenbeginn (Sonntag)") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = colorscheme, direction = 1, name = variable, end = .85)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_date(name = "Wochenbeginn (Sonntag)") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = colorscheme, direction = 1, name = variable, end = .85, begin = .1)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_date(name = "Wochenbeginn (Sonntag)") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = colorscheme, direction = 1, name = variable, end = .85, begin = .2)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
ggplot() + theme_void() +
geom_area(data = all_comb, aes(x = Sunday + 1, y = share, fill = indicator), color = "black", alpha = 1) +
geom_line(data = df_date, aes(x = Sunday + 1, y = n)) +
#geom_point(data = df_date, fill = "grey50", color = "black", shape = 21, position = "identity",
#           aes(x = Sunday + 1, y = n, size = n)) +
add_plot_layout(fontsize = 15) +
scale_x_date(name = "Wochenbeginn (Sonntag)") +
scale_y_continuous(limits = c(0, max(df_date$n)), expand = c(0,.5)) +
scale_size_continuous(limits = c(1, max(df_date$n)), range = c(1, max(df_date$n)*2)) +
scico::scale_fill_scico_d(palette = colorscheme, direction = 1, name = variable, end = .85, begin = .3)  +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
axis.title.y = element_blank(),
axis.line.y = element_blank(),
panel.grid.major.y = element_line(color = "grey80")
)
runApp("code/shiny")
runApp("code/shiny")
runApp("code/shiny")
runApp("code/shiny")
runApp("code/shiny")
