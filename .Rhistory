geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
head(grid)
grid = expand.grid(varable1 = v1, v2)
grid
grid = expand.grid(!!rlang::sym(variable1) = v1, v2)
grid = expand.grid(!!rlang::sym(variable1) := v1, v2)
grid = expand.grid(v1, v2) %>%
rename(!!rlang::sym(variable1) = v1,
grid = expand.grid(v1, v2) %>%
rename(!!rlang::sym(variable1) := v1,
!!rlang::sym(variable2) := v2)
variable1
variable2
grid = df %>%
select(!!rlang::sym(variable1), !!rlang::sym(variable2))
v1 = unique(grid[,1]) %>% pull()
v2 = unique(grid[,2]) %>% pull()
names(grid) <- c(variable1, variable2)
grid
v1 = unique(grid[,1]) %>% pull()
v2 = unique(grid[,2]) %>% pull()
grid = expand.grid(v1, v2)
names(grid) <- c(variable1, variable2)
grid
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
runApp("code/shiny")
df02
df02[,1]
v1 = unique(df01[,1]) %>% pull()
v2 = unique(df02[,2]) %>% pull()
grid = expand.grid(v1, v2)
names(grid) <- c(variable1, variable2)
grid
v1 = unique(df01[,1]) %>% pull()
v2 = unique(df02[,2]) %>% pull()
v2
v2 = unique(df02[,1]) %>% pull()
grid = expand.grid(v1, v2)
names(grid) <- c(variable1, variable2)
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
runApp("code/shiny")
grid
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
runApp("code/shiny")
runApp("code/shiny")
grid = df %>%
select(!!rlang::sym(variable1), !!rlang::sym(variable2))
v1 = unique(df01[,1]) %>% pull()
v2 = unique(df02[,1]) %>% pull()
grid = expand.grid(v1, v2)
names(grid) <- c(variable1, variable2)
grid
names(grid)
(p2 = ggplot() + theme_void() +
#geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
runApp("code/shiny")
runApp("code/shiny")
runApp("code/shiny")
runApp("code/shiny")
runApp("code/shiny")
(p2 = ggplot() + theme_void() +
geom_tile(data = df2, aes(x = unique(!!rlang::sym(variable1)), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,.75)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = df2, aes(x = 1, y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,.75)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = df2, aes(x = v1, y = v2, fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,.75)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = v1, y = v2, fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,.75)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = unique(!!rlang::sym(variable1)), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,.75)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
grid = df %>%
select(!!rlang::sym(variable1), !!rlang::sym(variable2))
v1 = unique(df01[,1]) %>% pull()
v2 = unique(df02[,1]) %>% pull()
grid = expand.grid(v1, v2)
names(grid) <- c(variable1, variable2)
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = unique(!!rlang::sym(variable1)), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,.75)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,.75)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(.5,0)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(.5,0)) +
scale_y_discrete(expand = c(.5,0)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(.5,0)) +
scale_y_discrete(expand = c(0,0)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(.5,0)) +
scale_y_discrete(expand = c(0,.5)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(.75,0)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,.75)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scico::scale_color_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
runApp("code/shiny")
grid = df %>%
select(!!rlang::sym(variable1), !!rlang::sym(variable2))
v1 = unique(df01[,1]) %>% pull()
v2 = unique(df02[,1]) %>% pull()
grid = expand.grid(v1, v2)
names(grid)
runApp("code/shiny")
Var1
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = Var1, y = Var2, fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0), name = variable1) +
scale_y_discrete(expand = c(0,0), name = variable2) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
runApp("code/shiny")
names(df)
variable2 = "Perspektive_Identität"
df01 = cutoff(df, variable1, thresh = thresh)
andere1 = df01[df01$indicator == "andere", ][[variable1]]
df02 = cutoff(df, variable2, thresh = thresh)
thresh = 2
df01 = cutoff(df, variable1, thresh = thresh)
andere1 = df01[df01$indicator == "andere", ][[variable1]]
df02 = cutoff(df, variable2, thresh = thresh)
andere2 = df02[df02$indicator == "andere", ][[variable2]]
df2 = df %>%
mutate(!!rlang::sym(variable1) := if_else(!!rlang::sym(variable1) %in% andere1,
"andere", !!rlang::sym(variable1)),
!!rlang::sym(variable2) := if_else(!!rlang::sym(variable2) %in% andere2,
"andere", !!rlang::sym(variable2))) %>%
group_by(across(c(-Datum, -Titel, -Sendung))) %>%
count() %>%
mutate(n = as.integer(n)) %>%
ungroup %>%
select(n, Name, !!rlang::sym(variable1), !!rlang::sym(variable2)) %>%
distinct()
grid = df %>%
select(!!rlang::sym(variable1), !!rlang::sym(variable2))
v1 = unique(df01[,1]) %>% pull()
v2 = unique(df02[,1]) %>% pull()
grid = expand.grid(v1, v2)
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = Var1, y = Var2, fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0), name = variable1) +
scale_y_discrete(expand = c(0,0), name = variable2) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
#geom_tile(data = grid, aes(x = Var1, y = Var2, fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0), name = variable1) +
scale_y_discrete(expand = c(0,0), name = variable2) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = Var1, y = Var2, fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
#geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
#           aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0), name = variable1) +
scale_y_discrete(expand = c(0,0), name = variable2) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
v2
df02
v1 = unique(df01[,3]) %>% pull()
v2 = unique(df02[,3]) %>% pull()
grid = expand.grid(v1, v2)
(p2 = ggplot() + theme_void() +
geom_tile(data = grid, aes(x = Var1, y = Var2, fill = NA, colour = 'grey80'), alpha = .3, linewidth = .05) +
geom_line(data = df2, position = position_jitter(width = .4, height = .4, seed = 123), linewidth = .3, alpha = .9, color = "grey0",
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2), group = Name)) +
geom_point(data = df2, shape = 21,  position = position_jitter(width = .4, height = .4, seed = 123),  alpha = .9,
aes(x = !!rlang::sym(variable1), y = !!rlang::sym(variable2),  fill = !!rlang::sym(variable1), size = n, text = Name)) +
scale_size_continuous(breaks = c(0, 1, 2, 3, 4), limits = c(0,max(df2$n))) +
scico::scale_fill_scico_d(palette = "batlow", direction = 1) +
scale_x_discrete(expand = c(0,0), name = variable1) +
scale_y_discrete(expand = c(0,0), name = variable2) +
add_plot_layout(fontsize = 15) +
theme(axis.text.x = element_text(size = 15, angle = 90),
axis.text.y = element_text(size = 15),
legend.position = "None"
))
runApp("code/shiny")
runApp("code/shiny")
